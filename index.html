<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora Rentabilidad Inmobiliaria</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #f5f5f5; }
    h1 { text-align: center; }
    .card { background: white; padding: 20px; border-radius: 10px; max-width: 600px; margin: auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; }
    input { width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 6px; }
    button { margin-top: 20px; padding: 10px; width: 100%; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0056b3; }
    .resultado { margin-top: 20px; padding: 15px; background: #eafaf1; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>Calculadora de rentabilidad alquiler larga duración</h1>
  <div class="card">
    <h4>Compra e inversión inicial</h4>
    <label>Precio de compra</label>
    <input type="number" id="precioCompra" placeholder="Ej: 75000€">

    <label>Reforma</label>
    <input type="number" id="costeReforma" placeholder="Ej: 2000€">

    <label>Mobiliario y equipamiento</label>
    <input type="number" id="costeMobiliarioEquipamiento" placeholder="Ej: 4000€">

    <label>Servicio agencia inmobiliaria</label>
    <input type="number" id="costeInmobiliaria" placeholder="Ej: 3000€, indicar sin IVA">

    <br><br>
    <hr>
    <h4>Gastos recurrentes</h4>
    <label>IBI</label>
    <input type="number" id="gastosIBI" placeholder="Ej: 350€ anuales">

    <label>Comunidad</label>
    <input type="number" id="gastosComunidad" placeholder="Ej: 50€ mensuales">
   
    <br><br>
    <hr>
    <h4>Datos de hipoteca</h4>
    <label>% de financiación sobr el valor de compra</label>
    <input type="number" id="porcentajeHipoteca" placeholder="Ej: 80%">

    <label>Años de hipoteca</label>
    <input type="number" id="anualidadesHipoteca" placeholder="Ej: 30">

    <label>Tipo de interés</label>
    <input type="number" id="tipoHipoteca" placeholder="Ej: 2.2%">

    <br><br>
    <hr>
    <h4>Alquiler</h4>
    <label>Ingresos mensuales por alquiler </label>
    <input type="number" id="ingresosAlquiler" placeholder="Ej: 800€">

    <button onclick="calcular()">Calcular rentabilidad</button>

    <div id="resultado" class="resultado" style="display:none;"></div>
  </div>

  <script>
    // Función para calcular la cuota mensual de hipoteca
    function calcularCuotaHipoteca(precioCompra, porcentajeHipoteca, tipoHipoteca, anualidadesHipoteca) {
        // Capital financiado
        const capital = precioCompra * (porcentajeHipoteca / 100);
        // Interés mensual (ej: 2.5% anual → 0.025/12)
        const interesMensual = (tipoHipoteca / 100) / 12;
        // Número de cuotas totales (años * 12)
        const numeroCuotas = anualidadesHipoteca * 12;
        // Fórmula de amortización francesa
        return capital * (interesMensual * Math.pow(1 + interesMensual, numeroCuotas)) / (Math.pow(1 + interesMensual, numeroCuotas) - 1);
      }
    function calcular() {
      const precioCompra = parseFloat(document.getElementById("precioCompra").value) || 0;
      const costeReforma = parseFloat(document.getElementById("costeReforma").value) || 0;
      const costeMobiliarioEquipamiento = parseFloat(document.getElementById("costeMobiliarioEquipamiento").value) || 0;
      const costeInmobiliaria = parseFloat(document.getElementById("costeInmobiliaria").value) || 0;
      const gastosIBI = parseFloat(document.getElementById("gastosIBI").value) || 0;
      const gastosComunidad = parseFloat(document.getElementById("gastosComunidad").value) || 0;
      const porcentajeHipoteca = parseFloat(document.getElementById("porcentajeHipoteca").value) || 0;
      const anualidadesHipoteca = parseFloat(document.getElementById("anualidadesHipoteca").value) || 0;
      const tipoHipoteca = parseFloat(document.getElementById("tipoHipoteca").value) || 0;
      const ingresosAlquiler = parseFloat(document.getElementById("ingresosAlquiler").value) || 0;

      // Configuración de gastos
      const tasacion = 300 * 1.21;
      const seguroImpago = ingresosAlquiler * 0.5;
      const seguroHogar = 300;

      // Cuota hipotecaria
      const cuotaHipoteca= calcularCuotaHipoteca(precioCompra, porcentajeHipoteca, tipoHipoteca, anualidadesHipoteca);

      // Se suma un ITP 10% al precio de compra y el IVA al gasto de la inmobiliaria
      const inversionTotal = precioCompra * 1.1 + costeReforma + costeMobiliarioEquipamiento + costeInmobiliaria * 1.21 + tasacion;
      // Se asume un 2% de gastos de notaría, registro y gestoría que se suma al ITP resultando en un valor del 0.12% del precio de compra
      const capitalAportado = precioCompra * 0.12 + costeReforma + costeMobiliarioEquipamiento + costeInmobiliaria * 1.21 + tasacion;

      const ingresosBrutosAnuales = ingresosAlquiler * 12;
      const gastosAnuales = gastosIBI + (gastosComunidad * 12) + seguroImpago + seguroHogar + (cuotaHipoteca * 12);
      const ingresosNetosAnuales = ingresosBrutosAnuales - gastosAnuales;

      const rentabilidadBruta = (ingresosBrutosAnuales / inversionTotal) * 100;
      const rentabilidadNeta = (ingresosNetosAnuales / inversionTotal) * 100;
      const cashFlowMensual = ingresosAlquiler - cuotaHipoteca - (gastosAnuales / 12)
    
      document.getElementById("resultado").style.display = "block";
      document.getElementById("resultado").innerHTML = `
        <b>Inversión total:</b> ${inversionTotal.toFixed(2)}€ <br>
        <b>Ingresos netos anuales:</b> ${ingresosNetosAnuales.toFixed(2)}€ <br>
        <b>Rentabilidad bruta:</b> ${rentabilidadBruta.toFixed(2)}% <br>
        <b>Rentabilidad neta:</b> ${rentabilidadNeta.toFixed(2)}% <br>
        <b>Cuota hipotecaria:</b> ${cuotaHipoteca.toFixed(2)}€ <br>
        <b>Cash-flow mensual:</b> ${cashFlowMensual.toFixed(2)}€
      `;
    }
  </script>
</body>
</html>

<!-- AÑADIR 
✓ compra 
✓ reforma 
✓ mobiliario 
✓ comisión agencia inmobiliaria 
✓ IBI, indicar en el placeholder que es anual
✓ comunidad, el importe será mensual, indicar en el placeholder
OPCIONAL Añadir input seguro de vida, indicar en el placeholder que es anual

AÑADIR HIPOTECA
✓ % financiación
✓ años de hipoteca
✓ % tipo de interés

CALCULAR
✓ ITP 10%
✓ notaría, registro, gestoría... 2%
✓ coste fijo tasación 300€ + IVA = 363€ 
✓ seguro de impago = mensualidad/2
✓ seguro de hogar = 300€
- añadir un escrito explicando los supuestos y costes hardcodeados -->

<!-- RESULTADOS
✓ rentabilidad bruta
- rentabilidad neta
✓ cuota hipotecaria
- cash-flow mensual
- % hipoteca/alquiler
- cash on cash
- ROCE -->